!function(t){function e(o){if(i[o])return i[o].exports;var r=i[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var i={};e.m=t,e.c=i,e.i=function(t){return t},e.d=function(t,i,o){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,i){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){function e(e){return this.each(function(){var r=t(this),s=r.data("patternLock"),n=t.extend({},i.DEFAULTS,r.data(),"object"==(void 0===e?"undefined":o(e))&&e);s||r.data("patternLock",s=new i(this,n)),"string"==typeof e&&s[e]()})}if(void 0===t)throw new Error("Pattern lock need jquery as a dependency.");var i=function(e,i){this.$el=t(e),this.canvas=e,this.options=i,this.context=e.getContext("2d"),this.width=e.width,this.height=e.height,this.originalDrawing=null,this.currentCircle=-1,this.drawingSurface=null,this.rubberbandRect={},this.result=[],this.initPassword="",this.init()};i.DEFAULTS={mode:"set",minLength:5,lineColor:"#888",circleStrokeColor:"#888",circleFillColor:"#f00",lineWidth:2,radius:.07,centers:[[.15,.15],[.5,.15],[.85,.15],[.15,.5],[.5,.5],[.85,.5],[.15,.85],[.5,.85],[.85,.85]]},i.prototype.init=function(){this.options.centers.forEach(t.proxy(function(t){this.drawCircle(t[0],t[1],this.options.radius,"stroke")}),this),this.originalDrawing=this.saveDrawing(),this.$el.on("touchstart",t.proxy(this.onMouseDownOrTouchStart,this)),this.$el.on("mousedown",t.proxy(this.onMouseDownOrTouchStart,this))},i.prototype.drawCircle=function(e,i,o,r,s){this.context=t.extend(this.context,{strokeStyle:this.options.circleStrokeColor,lineWidth:this.options.lineWidth,fillStyle:this.options.circleFillColor},s||{}),this.context.beginPath(),this.context.arc(this.width*e,this.height*i,this.width*o,0,2*Math.PI),"stroke"===r?this.context.stroke():this.context.fill()},i.prototype.drawLine=function(e,i,o,r,s){this.context=t.extend(this.context,{strokeStyle:this.options.lineColor,lineWidth:this.options.lineWidth},s||{}),this.context.beginPath(),this.context.moveTo(e,i),this.context.lineTo(o,r),this.context.stroke()},i.prototype.saveDrawing=function(){return this.context.getImageData(0,0,this.width,this.height)},i.prototype.restoreDrawing=function(t){t&&this.context.putImageData(t,0,0)},i.prototype.getEvtPos=function(t){return{x:t.pageX||t.originalEvent.touches[0].pageX,y:t.pageY||t.originalEvent.touches[0].pageY}},i.prototype.windowToCanvas=function(t,e){var i=this.canvas.getBoundingClientRect();return{x:t-i.left*(this.canvas.width/i.width),y:e-i.top*(this.canvas.height/i.height)}},i.prototype.getStdPos=function(t){return{x:t.x/this.width,y:t.y/this.height}},i.prototype.getTargetCircle=function(t){for(var e=this.options.centers,i=this.options.radius,o=0;o<9;o++)if(t.x<e[o][0]+i&&t.x>e[o][0]-i&&t.y<e[o][1]+i&&t.y>e[o][1]-i)return o},i.prototype.updateRubberbandRect=function(t){var e=this.options.centers,i=e[this.currentCircle][0],o=e[this.currentCircle][1];this.rubberbandRect.width=Math.abs(t.x-i),this.rubberbandRect.height=Math.abs(t.y-o),t.x>i?this.rubberbandRect.left=i:this.rubberbandRect.left=t.x,t.y>o?this.rubberbandRect.top=o:this.rubberbandRect.top=t.y},i.prototype.drawRubberband=function(t){var e=this.options.centers;this.drawLine(e[this.currentCircle][0]*this.width,e[this.currentCircle][1]*this.height,t.x*this.width,t.y*this.height)},i.prototype.updateRubberband=function(t){this.updateRubberbandRect(t),this.drawRubberband(t)},i.prototype.onMouseDownOrTouchStart=function(e){e.preventDefault();var i=this.getEvtPos(e),o=this.getStdPos(this.windowToCanvas(i.x,i.y)),r=this.getTargetCircle(o),s=this.options.centers,n=this.options.radius;void 0!==r&&(this.currentCircle=r,this.result.push(r),this.drawCircle(s[r][0],s[r][1],n,"fill"),this.drawingSurface=this.saveDrawing(),this.$el.on("touchmove",t.proxy(this.onMouseMoveOrTouchMove,this)),this.$el.on("touchend",t.proxy(this.onMouseUpOrTouchEnd,this)),this.$el.on("mousemove",t.proxy(this.onMouseMoveOrTouchMove,this)),this.$el.on("mouseup",t.proxy(this.onMouseUpOrTouchEnd,this)))},i.prototype.onMouseMoveOrTouchMove=function(t){t.preventDefault();var e=this.getEvtPos(t),i=this.getStdPos(this.windowToCanvas(e.x,e.y)),o=this.getTargetCircle(i),r=this.options.centers,s=this.options.radius;if(void 0!==o){if(this.result.indexOf(o)>-1)return;return this.restoreDrawing(this.drawingSurface),i.x=r[o][0],i.y=r[o][1],this.updateRubberband(i),this.result.push(o),this.drawCircle(r[o][0],r[o][1],s,"fill"),this.currentCircle=o,void(this.drawingSurface=this.saveDrawing())}this.restoreDrawing(this.drawingSurface),this.updateRubberband(i)},i.prototype.onMouseUpOrTouchEnd=function(e){this.restoreDrawing(this.drawingSurface),this.$el.off("touchmove"),this.$el.off("touchend"),this.$el.off("mousemove"),this.$el.off("mouseup");var i=this.result.join("");if("set"===this.options.mode)if(i.length<this.options.minLength){var o=t.Event("short.gesturepassword");this.$el.trigger(o)}else{this.initPassword=i,this.options.mode="again";var r=t.Event("init.gesturepassword",{initPassword:this.initPassword});this.$el.trigger(r)}else if("again"===this.options.mode)if(this.initPassword!==i){var s=t.Event("diff.gesturepassword",{diffPassword:i});this.$el.trigger(s)}else{var n=t.Event("set.gesturepassword");this.$el.trigger(n),localStorage.setItem("gesture-password",i)}else if("validate"===this.options.mode){var h=localStorage.getItem("gesture-password");if(i!==h){var a=t.Event("wrong.gesturepassword",{wrongPassword:i});this.$el.trigger(a)}else{var u=t.Event("correct.gesturepassword");this.$el.trigger(u)}}this.result=[],this.drawingSurface=null,setTimeout(t.proxy(function(){this.restoreDrawing(this.originalDrawing)},this),500)},i.prototype.set=function(){this.options.mode="set"},i.prototype.validate=function(){this.options.mode="validate"},i.prototype.disable=function(){this.$el.off("mousedown"),this.$el.off("touchstart")},i.prototype.enable=function(){this.$el.on("mousedown",t.proxy(this.onMouseDownOrTouchStart,this)),this.$el.on("touchstart",t.proxy(this.onMouseDownOrTouchStart,this))};var r=t.fn.patternLock;t.fn.patternLock=e,t.fn.patternLock.Constructor=i,t.fn.patternLock.noConflict=function(){return t.fn.patternLock=r,this},t(function(){e.call(t(".pattern-lock"))})}(jQuery)}]);